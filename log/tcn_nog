2019-04-21 07:55:11.300601: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-04-21 07:55:12.339732: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:02:00.0
totalMemory: 15.90GiB freeMemory: 6.03GiB
2019-04-21 07:55:12.339802: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-04-21 07:55:13.374819: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-04-21 07:55:13.374891: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-04-21 07:55:13.374902: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-04-21 07:55:13.375302: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 5810 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:02:00.0, compute capability: 6.0)
Namespace(BN=1, gpu='0', len_local=7, lr=0.0001, nb_stacks=2, neighbor_size=3, num_cnn=6, num_tcn=2)

 Load data elapsed time : 0.305 seconds

==============================
Model: "tcn_nog"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
stack_local_flow (InputLayer)   (None, 14, 7, 7)     0                                            
__________________________________________________________________________________________________
reshape_2 (Reshape)             (None, 7, 98)        0           stack_local_flow[0][0]           
__________________________________________________________________________________________________
conv1d_1 (Conv1D)               (None, 7, 64)        6336        reshape_2[0][0]                  
__________________________________________________________________________________________________
conv1d_2 (Conv1D)               (None, 7, 64)        8256        conv1d_1[0][0]                   
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 7, 64)        0           conv1d_2[0][0]                   
__________________________________________________________________________________________________
spatial_dropout1d_1 (SpatialDro (None, 7, 64)        0           activation_10[0][0]              
__________________________________________________________________________________________________
conv1d_3 (Conv1D)               (None, 7, 64)        8256        spatial_dropout1d_1[0][0]        
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 7, 64)        0           conv1d_3[0][0]                   
__________________________________________________________________________________________________
spatial_dropout1d_2 (SpatialDro (None, 7, 64)        0           activation_11[0][0]              
__________________________________________________________________________________________________
conv1d_4 (Conv1D)               (None, 7, 64)        4160        conv1d_1[0][0]                   
__________________________________________________________________________________________________
add_1 (Add)                     (None, 7, 64)        0           conv1d_4[0][0]                   
                                                                 spatial_dropout1d_2[0][0]        
__________________________________________________________________________________________________
conv1d_5 (Conv1D)               (None, 7, 64)        8256        add_1[0][0]                      
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 7, 64)        0           conv1d_5[0][0]                   
__________________________________________________________________________________________________
spatial_dropout1d_3 (SpatialDro (None, 7, 64)        0           activation_12[0][0]              
__________________________________________________________________________________________________
conv1d_6 (Conv1D)               (None, 7, 64)        8256        spatial_dropout1d_3[0][0]        
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 7, 64)        0           conv1d_6[0][0]                   
__________________________________________________________________________________________________
spatial_dropout1d_4 (SpatialDro (None, 7, 64)        0           activation_13[0][0]              
__________________________________________________________________________________________________
conv1d_7 (Conv1D)               (None, 7, 64)        4160        add_1[0][0]                      
__________________________________________________________________________________________________
add_2 (Add)                     (None, 7, 64)        0           conv1d_7[0][0]                   
                                                                 spatial_dropout1d_4[0][0]        
__________________________________________________________________________________________________
conv1d_8 (Conv1D)               (None, 7, 64)        8256        add_2[0][0]                      
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 7, 64)        0           conv1d_8[0][0]                   
__________________________________________________________________________________________________
spatial_dropout1d_5 (SpatialDro (None, 7, 64)        0           activation_14[0][0]              
__________________________________________________________________________________________________
conv1d_9 (Conv1D)               (None, 7, 64)        8256        spatial_dropout1d_5[0][0]        
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 7, 64)        0           conv1d_9[0][0]                   
__________________________________________________________________________________________________
spatial_dropout1d_6 (SpatialDro (None, 7, 64)        0           activation_15[0][0]              
__________________________________________________________________________________________________
conv1d_10 (Conv1D)              (None, 7, 64)        4160        add_2[0][0]                      
__________________________________________________________________________________________________
add_3 (Add)                     (None, 7, 64)        0           conv1d_10[0][0]                  
                                                                 spatial_dropout1d_6[0][0]        
__________________________________________________________________________________________________
conv1d_11 (Conv1D)              (None, 7, 64)        8256        add_3[0][0]                      
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 7, 64)        0           conv1d_11[0][0]                  
__________________________________________________________________________________________________
spatial_dropout1d_7 (SpatialDro (None, 7, 64)        0           activation_16[0][0]              
__________________________________________________________________________________________________
conv1d_12 (Conv1D)              (None, 7, 64)        8256        spatial_dropout1d_7[0][0]        
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 7, 64)        0           conv1d_12[0][0]                  
__________________________________________________________________________________________________
spatial_dropout1d_8 (SpatialDro (None, 7, 64)        0           activation_17[0][0]              
__________________________________________________________________________________________________
conv1d_13 (Conv1D)              (None, 7, 64)        4160        add_3[0][0]                      
__________________________________________________________________________________________________
add_4 (Add)                     (None, 7, 64)        0           conv1d_13[0][0]                  
                                                                 spatial_dropout1d_8[0][0]        
__________________________________________________________________________________________________
conv1d_14 (Conv1D)              (None, 7, 64)        8256        add_4[0][0]                      
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 7, 64)        0           conv1d_14[0][0]                  
__________________________________________________________________________________________________
spatial_dropout1d_9 (SpatialDro (None, 7, 64)        0           activation_18[0][0]              
__________________________________________________________________________________________________
conv1d_15 (Conv1D)              (None, 7, 64)        8256        spatial_dropout1d_9[0][0]        
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 7, 64)        0           conv1d_15[0][0]                  
__________________________________________________________________________________________________
spatial_dropout1d_10 (SpatialDr (None, 7, 64)        0           activation_19[0][0]              
__________________________________________________________________________________________________
conv1d_16 (Conv1D)              (None, 7, 64)        4160        add_4[0][0]                      
__________________________________________________________________________________________________
add_5 (Add)                     (None, 7, 64)        0           conv1d_16[0][0]                  
                                                                 spatial_dropout1d_10[0][0]       
__________________________________________________________________________________________________
conv1d_17 (Conv1D)              (None, 7, 64)        8256        add_5[0][0]                      
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 7, 64)        0           conv1d_17[0][0]                  
__________________________________________________________________________________________________
spatial_dropout1d_11 (SpatialDr (None, 7, 64)        0           activation_20[0][0]              
__________________________________________________________________________________________________
conv1d_18 (Conv1D)              (None, 7, 64)        8256        spatial_dropout1d_11[0][0]       
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 7, 64)        0           conv1d_18[0][0]                  
__________________________________________________________________________________________________
spatial_dropout1d_12 (SpatialDr (None, 7, 64)        0           activation_21[0][0]              
__________________________________________________________________________________________________
conv1d_19 (Conv1D)              (None, 7, 64)        4160        add_5[0][0]                      
__________________________________________________________________________________________________
add_6 (Add)                     (None, 7, 64)        0           conv1d_19[0][0]                  
                                                                 spatial_dropout1d_12[0][0]       
__________________________________________________________________________________________________
conv1d_20 (Conv1D)              (None, 7, 64)        8256        add_6[0][0]                      
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 7, 64)        0           conv1d_20[0][0]                  
__________________________________________________________________________________________________
spatial_dropout1d_13 (SpatialDr (None, 7, 64)        0           activation_22[0][0]              
__________________________________________________________________________________________________
conv1d_21 (Conv1D)              (None, 7, 64)        8256        spatial_dropout1d_13[0][0]       
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 7, 64)        0           conv1d_21[0][0]                  
__________________________________________________________________________________________________
spatial_dropout1d_14 (SpatialDr (None, 7, 64)        0           activation_23[0][0]              
__________________________________________________________________________________________________
conv1d_22 (Conv1D)              (None, 7, 64)        4160        add_6[0][0]                      
__________________________________________________________________________________________________
add_7 (Add)                     (None, 7, 64)        0           conv1d_22[0][0]                  
                                                                 spatial_dropout1d_14[0][0]       
__________________________________________________________________________________________________
conv1d_23 (Conv1D)              (None, 7, 64)        8256        add_7[0][0]                      
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 7, 64)        0           conv1d_23[0][0]                  
__________________________________________________________________________________________________
spatial_dropout1d_15 (SpatialDr (None, 7, 64)        0           activation_24[0][0]              
__________________________________________________________________________________________________
conv1d_24 (Conv1D)              (None, 7, 64)        8256        spatial_dropout1d_15[0][0]       
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 7, 64)        0           conv1d_24[0][0]                  
__________________________________________________________________________________________________
spatial_dropout1d_16 (SpatialDr (None, 7, 64)        0           activation_25[0][0]              
__________________________________________________________________________________________________
conv1d_25 (Conv1D)              (None, 7, 64)        4160        add_7[0][0]                      
__________________________________________________________________________________________________
add_8 (Add)                     (None, 7, 64)        0           conv1d_25[0][0]                  
                                                                 spatial_dropout1d_16[0][0]       
__________________________________________________________________________________________________
conv1d_26 (Conv1D)              (None, 7, 64)        8256        add_8[0][0]                      
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 7, 64)        0           conv1d_26[0][0]                  
__________________________________________________________________________________________________
spatial_dropout1d_17 (SpatialDr (None, 7, 64)        0           activation_26[0][0]              
__________________________________________________________________________________________________
conv1d_27 (Conv1D)              (None, 7, 64)        8256        spatial_dropout1d_17[0][0]       
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 7, 64)        0           conv1d_27[0][0]                  
__________________________________________________________________________________________________
spatial_dropout1d_18 (SpatialDr (None, 7, 64)        0           activation_27[0][0]              
__________________________________________________________________________________________________
conv1d_28 (Conv1D)              (None, 7, 64)        4160        add_8[0][0]                      
__________________________________________________________________________________________________
add_9 (Add)                     (None, 7, 64)        0           conv1d_28[0][0]                  
                                                                 spatial_dropout1d_18[0][0]       
__________________________________________________________________________________________________
conv1d_29 (Conv1D)              (None, 7, 64)        8256        add_9[0][0]                      
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 7, 64)        0           conv1d_29[0][0]                  
__________________________________________________________________________________________________
spatial_dropout1d_19 (SpatialDr (None, 7, 64)        0           activation_28[0][0]              
__________________________________________________________________________________________________
conv1d_30 (Conv1D)              (None, 7, 64)        8256        spatial_dropout1d_19[0][0]       
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 7, 64)        0           conv1d_30[0][0]                  
__________________________________________________________________________________________________
spatial_dropout1d_20 (SpatialDr (None, 7, 64)        0           activation_29[0][0]              
__________________________________________________________________________________________________
conv1d_31 (Conv1D)              (None, 7, 64)        4160        add_9[0][0]                      
__________________________________________________________________________________________________
add_10 (Add)                    (None, 7, 64)        0           conv1d_31[0][0]                  
                                                                 spatial_dropout1d_20[0][0]       
__________________________________________________________________________________________________
conv1d_32 (Conv1D)              (None, 7, 64)        8256        add_10[0][0]                     
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 7, 64)        0           conv1d_32[0][0]                  
__________________________________________________________________________________________________
spatial_dropout1d_21 (SpatialDr (None, 7, 64)        0           activation_30[0][0]              
__________________________________________________________________________________________________
conv1d_33 (Conv1D)              (None, 7, 64)        8256        spatial_dropout1d_21[0][0]       
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 7, 64)        0           conv1d_33[0][0]                  
__________________________________________________________________________________________________
spatial_dropout1d_22 (SpatialDr (None, 7, 64)        0           activation_31[0][0]              
__________________________________________________________________________________________________
conv1d_34 (Conv1D)              (None, 7, 64)        4160        add_10[0][0]                     
__________________________________________________________________________________________________
add_11 (Add)                    (None, 7, 64)        0           conv1d_34[0][0]                  
                                                                 spatial_dropout1d_22[0][0]       
__________________________________________________________________________________________________
conv1d_35 (Conv1D)              (None, 7, 64)        8256        add_11[0][0]                     
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 7, 64)        0           conv1d_35[0][0]                  
__________________________________________________________________________________________________
spatial_dropout1d_23 (SpatialDr (None, 7, 64)        0           activation_32[0][0]              
__________________________________________________________________________________________________
conv1d_36 (Conv1D)              (None, 7, 64)        8256        spatial_dropout1d_23[0][0]       
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 7, 64)        0           conv1d_36[0][0]                  
__________________________________________________________________________________________________
spatial_dropout1d_24 (SpatialDr (None, 7, 64)        0           activation_33[0][0]              
__________________________________________________________________________________________________
add_13 (Add)                    (None, 7, 64)        0           spatial_dropout1d_2[0][0]        
                                                                 spatial_dropout1d_4[0][0]        
                                                                 spatial_dropout1d_6[0][0]        
                                                                 spatial_dropout1d_8[0][0]        
                                                                 spatial_dropout1d_10[0][0]       
                                                                 spatial_dropout1d_12[0][0]       
                                                                 spatial_dropout1d_14[0][0]       
                                                                 spatial_dropout1d_16[0][0]       
                                                                 spatial_dropout1d_18[0][0]       
                                                                 spatial_dropout1d_20[0][0]       
                                                                 spatial_dropout1d_22[0][0]       
                                                                 spatial_dropout1d_24[0][0]       
__________________________________________________________________________________________________
conv1d_38 (Conv1D)              (None, 7, 64)        4160        add_13[0][0]                     
__________________________________________________________________________________________________
conv1d_39 (Conv1D)              (None, 7, 64)        8256        conv1d_38[0][0]                  
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 7, 64)        0           conv1d_39[0][0]                  
__________________________________________________________________________________________________
spatial_dropout1d_25 (SpatialDr (None, 7, 64)        0           activation_34[0][0]              
__________________________________________________________________________________________________
conv1d_40 (Conv1D)              (None, 7, 64)        8256        spatial_dropout1d_25[0][0]       
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 7, 64)        0           conv1d_40[0][0]                  
__________________________________________________________________________________________________
spatial_dropout1d_26 (SpatialDr (None, 7, 64)        0           activation_35[0][0]              
__________________________________________________________________________________________________
conv1d_41 (Conv1D)              (None, 7, 64)        4160        conv1d_38[0][0]                  
__________________________________________________________________________________________________
add_14 (Add)                    (None, 7, 64)        0           conv1d_41[0][0]                  
                                                                 spatial_dropout1d_26[0][0]       
__________________________________________________________________________________________________
conv1d_42 (Conv1D)              (None, 7, 64)        8256        add_14[0][0]                     
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 7, 64)        0           conv1d_42[0][0]                  
__________________________________________________________________________________________________
spatial_dropout1d_27 (SpatialDr (None, 7, 64)        0           activation_36[0][0]              
__________________________________________________________________________________________________
conv1d_43 (Conv1D)              (None, 7, 64)        8256        spatial_dropout1d_27[0][0]       
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 7, 64)        0           conv1d_43[0][0]                  
__________________________________________________________________________________________________
spatial_dropout1d_28 (SpatialDr (None, 7, 64)        0           activation_37[0][0]              
__________________________________________________________________________________________________
conv1d_44 (Conv1D)              (None, 7, 64)        4160        add_14[0][0]                     
__________________________________________________________________________________________________
add_15 (Add)                    (None, 7, 64)        0           conv1d_44[0][0]                  
                                                                 spatial_dropout1d_28[0][0]       
__________________________________________________________________________________________________
conv1d_45 (Conv1D)              (None, 7, 64)        8256        add_15[0][0]                     
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 7, 64)        0           conv1d_45[0][0]                  
__________________________________________________________________________________________________
spatial_dropout1d_29 (SpatialDr (None, 7, 64)        0           activation_38[0][0]              
__________________________________________________________________________________________________
conv1d_46 (Conv1D)              (None, 7, 64)        8256        spatial_dropout1d_29[0][0]       
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 7, 64)        0           conv1d_46[0][0]                  
__________________________________________________________________________________________________
spatial_dropout1d_30 (SpatialDr (None, 7, 64)        0           activation_39[0][0]              
__________________________________________________________________________________________________
conv1d_47 (Conv1D)              (None, 7, 64)        4160        add_15[0][0]                     
__________________________________________________________________________________________________
add_16 (Add)                    (None, 7, 64)        0           conv1d_47[0][0]                  
                                                                 spatial_dropout1d_30[0][0]       
__________________________________________________________________________________________________
conv1d_48 (Conv1D)              (None, 7, 64)        8256        add_16[0][0]                     
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 7, 64)        0           conv1d_48[0][0]                  
__________________________________________________________________________________________________
spatial_dropout1d_31 (SpatialDr (None, 7, 64)        0           activation_40[0][0]              
__________________________________________________________________________________________________
conv1d_49 (Conv1D)              (None, 7, 64)        8256        spatial_dropout1d_31[0][0]       
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 7, 64)        0           conv1d_49[0][0]                  
__________________________________________________________________________________________________
spatial_dropout1d_32 (SpatialDr (None, 7, 64)        0           activation_41[0][0]              
__________________________________________________________________________________________________
conv1d_50 (Conv1D)              (None, 7, 64)        4160        add_16[0][0]                     
__________________________________________________________________________________________________
add_17 (Add)                    (None, 7, 64)        0           conv1d_50[0][0]                  
                                                                 spatial_dropout1d_32[0][0]       
__________________________________________________________________________________________________
conv1d_51 (Conv1D)              (None, 7, 64)        8256        add_17[0][0]                     
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 7, 64)        0           conv1d_51[0][0]                  
__________________________________________________________________________________________________
spatial_dropout1d_33 (SpatialDr (None, 7, 64)        0           activation_42[0][0]              
__________________________________________________________________________________________________
conv1d_52 (Conv1D)              (None, 7, 64)        8256        spatial_dropout1d_33[0][0]       
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 7, 64)        0           conv1d_52[0][0]                  
__________________________________________________________________________________________________
spatial_dropout1d_34 (SpatialDr (None, 7, 64)        0           activation_43[0][0]              
__________________________________________________________________________________________________
conv1d_53 (Conv1D)              (None, 7, 64)        4160        add_17[0][0]                     
__________________________________________________________________________________________________
add_18 (Add)                    (None, 7, 64)        0           conv1d_53[0][0]                  
                                                                 spatial_dropout1d_34[0][0]       
__________________________________________________________________________________________________
conv1d_54 (Conv1D)              (None, 7, 64)        8256        add_18[0][0]                     
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 7, 64)        0           conv1d_54[0][0]                  
__________________________________________________________________________________________________
spatial_dropout1d_35 (SpatialDr (None, 7, 64)        0           activation_44[0][0]              
__________________________________________________________________________________________________
conv1d_55 (Conv1D)              (None, 7, 64)        8256        spatial_dropout1d_35[0][0]       
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 7, 64)        0           conv1d_55[0][0]                  
__________________________________________________________________________________________________
spatial_dropout1d_36 (SpatialDr (None, 7, 64)        0           activation_45[0][0]              
__________________________________________________________________________________________________
conv1d_56 (Conv1D)              (None, 7, 64)        4160        add_18[0][0]                     
__________________________________________________________________________________________________
add_19 (Add)                    (None, 7, 64)        0           conv1d_56[0][0]                  
                                                                 spatial_dropout1d_36[0][0]       
__________________________________________________________________________________________________
conv1d_57 (Conv1D)              (None, 7, 64)        8256        add_19[0][0]                     
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 7, 64)        0           conv1d_57[0][0]                  
__________________________________________________________________________________________________
spatial_dropout1d_37 (SpatialDr (None, 7, 64)        0           activation_46[0][0]              
__________________________________________________________________________________________________
conv1d_58 (Conv1D)              (None, 7, 64)        8256        spatial_dropout1d_37[0][0]       
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 7, 64)        0           conv1d_58[0][0]                  
__________________________________________________________________________________________________
spatial_dropout1d_38 (SpatialDr (None, 7, 64)        0           activation_47[0][0]              
__________________________________________________________________________________________________
conv1d_59 (Conv1D)              (None, 7, 64)        4160        add_19[0][0]                     
__________________________________________________________________________________________________
add_20 (Add)                    (None, 7, 64)        0           conv1d_59[0][0]                  
                                                                 spatial_dropout1d_38[0][0]       
__________________________________________________________________________________________________
conv1d_60 (Conv1D)              (None, 7, 64)        8256        add_20[0][0]                     
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 7, 64)        0           conv1d_60[0][0]                  
__________________________________________________________________________________________________
spatial_dropout1d_39 (SpatialDr (None, 7, 64)        0           activation_48[0][0]              
__________________________________________________________________________________________________
conv1d_61 (Conv1D)              (None, 7, 64)        8256        spatial_dropout1d_39[0][0]       
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 7, 64)        0           conv1d_61[0][0]                  
__________________________________________________________________________________________________
spatial_dropout1d_40 (SpatialDr (None, 7, 64)        0           activation_49[0][0]              
__________________________________________________________________________________________________
conv1d_62 (Conv1D)              (None, 7, 64)        4160        add_20[0][0]                     
__________________________________________________________________________________________________
add_21 (Add)                    (None, 7, 64)        0           conv1d_62[0][0]                  
                                                                 spatial_dropout1d_40[0][0]       
__________________________________________________________________________________________________
conv1d_63 (Conv1D)              (None, 7, 64)        8256        add_21[0][0]                     
__________________________________________________________________________________________________
activation_50 (Activation)      (None, 7, 64)        0           conv1d_63[0][0]                  
__________________________________________________________________________________________________
spatial_dropout1d_41 (SpatialDr (None, 7, 64)        0           activation_50[0][0]              
__________________________________________________________________________________________________
conv1d_64 (Conv1D)              (None, 7, 64)        8256        spatial_dropout1d_41[0][0]       
__________________________________________________________________________________________________
activation_51 (Activation)      (None, 7, 64)        0           conv1d_64[0][0]                  
__________________________________________________________________________________________________
spatial_dropout1d_42 (SpatialDr (None, 7, 64)        0           activation_51[0][0]              
__________________________________________________________________________________________________
conv1d_65 (Conv1D)              (None, 7, 64)        4160        add_21[0][0]                     
__________________________________________________________________________________________________
add_22 (Add)                    (None, 7, 64)        0           conv1d_65[0][0]                  
                                                                 spatial_dropout1d_42[0][0]       
__________________________________________________________________________________________________
conv1d_66 (Conv1D)              (None, 7, 64)        8256        add_22[0][0]                     
__________________________________________________________________________________________________
activation_52 (Activation)      (None, 7, 64)        0           conv1d_66[0][0]                  
__________________________________________________________________________________________________
spatial_dropout1d_43 (SpatialDr (None, 7, 64)        0           activation_52[0][0]              
__________________________________________________________________________________________________
current_local_flow (InputLayer) (None, 2, 7, 7)      0                                            
__________________________________________________________________________________________________
conv1d_67 (Conv1D)              (None, 7, 64)        8256        spatial_dropout1d_43[0][0]       
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 2, 7, 7)      8           current_local_flow[0][0]         
__________________________________________________________________________________________________
activation_53 (Activation)      (None, 7, 64)        0           conv1d_67[0][0]                  
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 2, 7, 7)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
spatial_dropout1d_44 (SpatialDr (None, 7, 64)        0           activation_53[0][0]              
__________________________________________________________________________________________________
conv1d_68 (Conv1D)              (None, 7, 64)        4160        add_22[0][0]                     
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 32, 7, 7)     608         activation_3[0][0]               
__________________________________________________________________________________________________
add_23 (Add)                    (None, 7, 64)        0           conv1d_68[0][0]                  
                                                                 spatial_dropout1d_44[0][0]       
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 32, 7, 7)     128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv1d_69 (Conv1D)              (None, 7, 64)        8256        add_23[0][0]                     
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 32, 7, 7)     0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
activation_54 (Activation)      (None, 7, 64)        0           conv1d_69[0][0]                  
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 32, 7, 7)     9248        activation_4[0][0]               
__________________________________________________________________________________________________
spatial_dropout1d_45 (SpatialDr (None, 7, 64)        0           activation_54[0][0]              
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 32, 7, 7)     128         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv1d_70 (Conv1D)              (None, 7, 64)        8256        spatial_dropout1d_45[0][0]       
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 32, 7, 7)     0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
activation_55 (Activation)      (None, 7, 64)        0           conv1d_70[0][0]                  
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 32, 7, 7)     9248        activation_5[0][0]               
__________________________________________________________________________________________________
spatial_dropout1d_46 (SpatialDr (None, 7, 64)        0           activation_55[0][0]              
__________________________________________________________________________________________________
conv1d_71 (Conv1D)              (None, 7, 64)        4160        add_23[0][0]                     
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 32, 7, 7)     128         conv2d_3[0][0]                   
__________________________________________________________________________________________________
add_24 (Add)                    (None, 7, 64)        0           conv1d_71[0][0]                  
                                                                 spatial_dropout1d_46[0][0]       
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 32, 7, 7)     0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
conv1d_72 (Conv1D)              (None, 7, 64)        8256        add_24[0][0]                     
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 32, 7, 7)     9248        activation_6[0][0]               
__________________________________________________________________________________________________
activation_56 (Activation)      (None, 7, 64)        0           conv1d_72[0][0]                  
__________________________________________________________________________________________________
t_vacation (InputLayer)         (None, 7)            0                                            
__________________________________________________________________________________________________
t_hour (InputLayer)             (None, 7)            0                                            
__________________________________________________________________________________________________
t_dayOfWeek (InputLayer)        (None, 7)            0                                            
__________________________________________________________________________________________________
t_weather (InputLayer)          (None, 7)            0                                            
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 32, 7, 7)     128         conv2d_4[0][0]                   
__________________________________________________________________________________________________
spatial_dropout1d_47 (SpatialDr (None, 7, 64)        0           activation_56[0][0]              
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 7, 2)         4           t_vacation[0][0]                 
__________________________________________________________________________________________________
embedding_2 (Embedding)         (None, 7, 2)         50          t_hour[0][0]                     
__________________________________________________________________________________________________
embedding_3 (Embedding)         (None, 7, 2)         14          t_dayOfWeek[0][0]                
__________________________________________________________________________________________________
embedding_4 (Embedding)         (None, 7, 2)         34          t_weather[0][0]                  
__________________________________________________________________________________________________
t_continuous_external (InputLay (None, 7, 2)         0                                            
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 32, 7, 7)     0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
conv1d_73 (Conv1D)              (None, 7, 64)        8256        spatial_dropout1d_47[0][0]       
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 7, 10)        0           embedding_1[0][0]                
                                                                 embedding_2[0][0]                
                                                                 embedding_3[0][0]                
                                                                 embedding_4[0][0]                
                                                                 t_continuous_external[0][0]      
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 32, 7, 7)     9248        activation_7[0][0]               
__________________________________________________________________________________________________
activation_57 (Activation)      (None, 7, 64)        0           conv1d_73[0][0]                  
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 70)           0           concatenate_1[0][0]              
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 32, 7, 7)     128         conv2d_5[0][0]                   
__________________________________________________________________________________________________
spatial_dropout1d_48 (SpatialDr (None, 7, 64)        0           activation_57[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 50)           3550        flatten_1[0][0]                  
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 32, 7, 7)     0           batch_normalization_6[0][0]      
__________________________________________________________________________________________________
add_26 (Add)                    (None, 7, 64)        0           spatial_dropout1d_26[0][0]       
                                                                 spatial_dropout1d_28[0][0]       
                                                                 spatial_dropout1d_30[0][0]       
                                                                 spatial_dropout1d_32[0][0]       
                                                                 spatial_dropout1d_34[0][0]       
                                                                 spatial_dropout1d_36[0][0]       
                                                                 spatial_dropout1d_38[0][0]       
                                                                 spatial_dropout1d_40[0][0]       
                                                                 spatial_dropout1d_42[0][0]       
                                                                 spatial_dropout1d_44[0][0]       
                                                                 spatial_dropout1d_46[0][0]       
                                                                 spatial_dropout1d_48[0][0]       
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 50)           0           dense_1[0][0]                    
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 32, 7, 7)     9248        activation_8[0][0]               
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 64)           0           add_26[0][0]                     
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 50)           0           dropout_1[0][0]                  
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 32, 7, 7)     0           conv2d_6[0][0]                   
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 98)           6370        lambda_1[0][0]                   
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 98)           4998        activation_1[0][0]               
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 2, 7, 7)      578         activation_9[0][0]               
__________________________________________________________________________________________________
reshape_3 (Reshape)             (None, 2, 7, 7)      0           dense_3[0][0]                    
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 98)           0           dense_2[0][0]                    
__________________________________________________________________________________________________
ilayer_1 (ilayer)               (None, 2, 7, 7)      98          conv2d_7[0][0]                   
__________________________________________________________________________________________________
ilayer_2 (ilayer)               (None, 2, 7, 7)      98          reshape_3[0][0]                  
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 2, 7, 7)      0           activation_2[0][0]               
__________________________________________________________________________________________________
add_27 (Add)                    (None, 2, 7, 7)      0           ilayer_1[0][0]                   
                                                                 ilayer_2[0][0]                   
__________________________________________________________________________________________________
add_28 (Add)                    (None, 2, 7, 7)      0           reshape_1[0][0]                  
                                                                 add_27[0][0]                     
__________________________________________________________________________________________________
activation_58 (Activation)      (None, 2, 7, 7)      0           add_28[0][0]                     
==================================================================================================
Total params: 561,594
Trainable params: 561,270
Non-trainable params: 324
__________________________________________________________________________________________________

Compiling model elapsed time : 2.733 seconds

==============================
Train on 27936 samples, validate on 3105 samples
Epoch 1/500
 - 99s - loss: 0.0577 - rmse: 0.1861 - mape: inf - val_loss: 0.0100 - val_rmse: 0.0962 - val_mape: inf
Epoch 2/500
 - 86s - loss: 0.0106 - rmse: 0.1025 - mape: inf - val_loss: 0.0070 - val_rmse: 0.0802 - val_mape: inf
Epoch 3/500
 - 85s - loss: 0.0077 - rmse: 0.0870 - mape: inf - val_loss: 0.0053 - val_rmse: 0.0696 - val_mape: inf
Epoch 4/500
 - 86s - loss: 0.0060 - rmse: 0.0767 - mape: inf - val_loss: 0.0044 - val_rmse: 0.0629 - val_mape: inf
Epoch 5/500
 - 86s - loss: 0.0049 - rmse: 0.0696 - mape: inf - val_loss: 0.0037 - val_rmse: 0.0572 - val_mape: inf
Epoch 6/500
 - 86s - loss: 0.0043 - rmse: 0.0645 - mape: inf - val_loss: 0.0032 - val_rmse: 0.0529 - val_mape: inf
Epoch 7/500
 - 86s - loss: 0.0037 - rmse: 0.0603 - mape: inf - val_loss: 0.0029 - val_rmse: 0.0503 - val_mape: inf
Epoch 8/500
 - 85s - loss: 0.0033 - rmse: 0.0566 - mape: inf - val_loss: 0.0026 - val_rmse: 0.0468 - val_mape: inf
Epoch 9/500
 - 84s - loss: 0.0030 - rmse: 0.0541 - mape: inf - val_loss: 0.0024 - val_rmse: 0.0441 - val_mape: inf
Epoch 10/500
 - 85s - loss: 0.0028 - rmse: 0.0519 - mape: inf - val_loss: 0.0024 - val_rmse: 0.0445 - val_mape: inf
Epoch 11/500
 - 85s - loss: 0.0027 - rmse: 0.0507 - mape: inf - val_loss: 0.0025 - val_rmse: 0.0456 - val_mape: inf
Using TensorFlow backend.

Training elapsed time: 979.025 seconds

==============================
evaluating using the model that has the best loss on the valid set
Train Loss: 0.002527 rmse (norm): 0.047881 rmse (real): 29.925441, mape: inf
Test Loss: 0.002200 rmse (norm): 0.046469 rmse (real): 29.042862, mape: inf
Evaluate elapsed time: 17.662 seconds

